<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>Simple CPU Simulator</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <div class="simulator">
            <div class="cpu">
                <div class="cpu-header">
                    <h2>CPU</h2>
                    <div class="mode-toggle">
                        <button id="modeToggleBtn" onclick="toggleExecutionMode()" title="Toggle Manual/Auto Mode">
                            <span id="modeLabel">Manual</span>
                            <svg id="toggleIcon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <circle cx="12" cy="12" r="3"></circle>
                                <path d="M12 1v6m0 6v6m8.66-13.66l-4.24 4.24m-4.84 4.84l-4.24 4.24M23 12h-6m-6 0H1m18.66 8.66l-4.24-4.24m-4.84-4.84l-4.24-4.24"></path>
                            </svg>
                        </button>
                    </div>
                </div>
                <div class="mode-controls">
                    <div id="manualControls" class="control-group">
                        <button id="clockTick" onclick="clockTick()">Clock Tick</button>
                    </div>
                    <div id="autoControls" class="control-group hidden">
                        <div class="interval-control">
                            <label for="intervalInput">Interval (ms):</label>
                            <input type="number" id="intervalInput" min="10" max="5000" step="10" value="100">
                        </div>
                        <button id="startBtn" onclick="startAuto()">Start</button>
                        <button id="stopBtn" onclick="stopAuto()" class="hidden">Stop</button>
                    </div>
                </div>
                <div class="register">
                    <h3>Program Counter</h3>
                    <div id="pc" class="register-value">0</div>
                </div>
                <div class="register">
                    <h3>Instruction Register</h3>
                    <div id="ir" class="register-value"></div>
                </div>
                <div class="register">
                    <h3>Accumulator</h3>
                    <div id="accumulator" class="register-value">0</div>
                </div>
                <div id="execution-phases">
                    <div class="execution-phase active-phase">â–º Fetch</div>
                    <div class="execution-phase">Decode</div>
                    <div class="execution-phase">Execute</div>
                </div>
            </div>
            <div class="ram">
                <div class="ram-header">
                    <h2>RAM</h2>
                    <div class="mode-switch">
                        <button id="modeToggle" onclick="toggleMode()">
                            <svg id="editIcon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                                <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                            </svg>
                            <svg id="viewIcon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="hidden">
                                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                                <circle cx="12" cy="12" r="3"></circle>
                            </svg>
                        </button>
                    </div>
                </div>
                <div class="ram-table-container">
                    <table id="ram-table">
                        <thead>
                            <tr>
                                <th>Address</th>
                                <th>Value</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- RAM rows will be dynamically inserted here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <button id="explanationToggle" onclick="toggleExplanation()">Show Explanation</button>
        <div id="explanation" class="explanation">
            <h2>What is this and how does it work?</h2>
            <p>This simulator demonstrates the basic functioning of a Central Processing Unit (CPU) in a computer. At its core, every modern computer operates on similar principles, no matter how complex its tasks may seem.</p>
            <p>The simulation shows three main components:</p>
            <ul>
                <li><strong>CPU:</strong> the brain of the computer, containing registers for temporary data storage and processing.</li>
                <li><strong>RAM (Random Access Memory):</strong> where instructions and data are stored for quick access.</li>
                <li><strong>Clock:</strong> represented by the "Clock Tick" button, it drives the CPU through its cycle.</li>
                 <li>The program counter keeps track of which instruction to execute next.</li>
            </ul>
            <p>The CPU operates in a continuous "Fetch-Decode-Execute" cycle:</p>
            <ol>
                <li><strong>Fetch:</strong> the CPU retrieves an instruction from RAM.</li>
                <li><strong>Decode:</strong> the CPU interprets the instruction.</li>
                <li><strong>Execute:</strong> the CPU carries out the instruction.</li>
            </ol>
            <p>In this simulator, you can see this cycle in action. The program loaded into RAM is a simple counting program. With each complete cycle, it increments a value stored in RAM.</p>
            <p>While this simulation runs at a speed we can observe, real CPUs execute billions of instructions per second. This incredible speed allows computers to perform complex tasks like playing video games or displaying this web page.</p>
            <p>You can interact with this simulator by clicking the "Clock Tick" button to step through each phase of the cycle, or by switching to "Edit Mode" to modify the instructions in RAM.</p>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
